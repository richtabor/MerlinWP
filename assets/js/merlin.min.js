var Merlin=function(_){var n={install_child:function(e){(new i).init(e)},activate_license:function(e){(new t).init(e)},install_plugins:function(e){(new s).init(e)},install_content:function(e){(new o).init(e)}};function e(){var i=_(".merlin__body"),e=(_(".merlin__body--loading"),_(".merlin__body--exiting"),_("#merlin__drawer-trigger"));drawer_opened="merlin__drawer--open",setTimeout(function(){i.addClass("loaded")},100),e.on("click",function(){i.toggleClass(drawer_opened)}),_(".merlin__button--proceed:not(.merlin__button--closer)").click(function(e){e.preventDefault();var n=this.getAttribute("href");i.addClass("exiting"),setTimeout(function(){window.location=n},400)}),_(".merlin__button--closer").on("click",function(e){i.removeClass(drawer_opened),e.preventDefault();var n=this.getAttribute("href");setTimeout(function(){i.addClass("exiting")},600),setTimeout(function(){window.location=n},1100)}),_(".button-next").on("click",function(e){return e.preventDefault(),!(!function(e){var n=jQuery(e);if("yes"==n.data("done-loading"))return!1;n.is("input")||n.is("button");return n.data("done-loading","yes"),n.addClass("merlin__button--loading"),{done:function(){n.attr("disabled",!1)}}}(this)||(e=_(this).data("callback"))&&void 0!==n[e]&&(n[e](this),1))}),_(document).on("change",".js-merlin-demo-import-select",function(){var e=_(this).val();_(".js-merlin-select-spinner").show(),_.post(merlin_params.ajaxurl,{action:"merlin_update_selected_import_data_info",wpnonce:merlin_params.wpnonce,selected_index:e},function(e){e.success?_(".js-merlin-drawer-import-content").html(e.data):alert(merlin_params.texts.something_went_wrong),_(".js-merlin-select-spinner").hide()}).fail(function(){_(".js-merlin-select-spinner").hide(),alert(merlin_params.texts.something_went_wrong)})})}function i(){var n,i=_(".merlin__body"),t=_("#child-theme-text");function s(e){void 0!==e.done?(setTimeout(function(){t.addClass("lead")},0),setTimeout(function(){t.addClass("success"),t.html(e.message)},600),n()):(t.addClass("lead error"),t.html(e.error))}return{init:function(e){n=function(){setTimeout(function(){_(".merlin__body").addClass("js--finished")},1500),i.removeClass(drawer_opened),setTimeout(function(){_(".merlin__body").addClass("exiting")},3500),setTimeout(function(){window.location.href=e.href},4e3)},jQuery.post(merlin_params.ajaxurl,{action:"merlin_child_theme",wpnonce:merlin_params.wpnonce},s).fail(s)}}}function t(){var n,i=_(".merlin__body"),t=_(".merlin__content--license-key"),s=_("#license-text");function o(e){void 0!==e.success&&e.success?(s.siblings(".error-message").remove(),setTimeout(function(){s.addClass("lead")},0),setTimeout(function(){s.addClass("success"),s.html(e.message)},600),n()):(_(".js-merlin-license-activate-button").removeClass("merlin__button--loading").data("done-loading","no"),s.siblings(".error-message").remove(),t.addClass("has-error"),s.html(e.message),s.siblings(".error-message").addClass("lead error"))}return{init:function(e){n=function(){setTimeout(function(){_(".merlin__body").addClass("js--finished")},1500),i.removeClass(drawer_opened),setTimeout(function(){_(".merlin__body").addClass("exiting")},3500),setTimeout(function(){window.location.href=e.href},4e3)},t.removeClass("has-error"),jQuery.post(merlin_params.ajaxurl,{action:"merlin_activate_license",wpnonce:merlin_params.wpnonce,license_key:_(".js-license-key").val()},o).fail(o)}}}function s(){var n,i,t=_(".merlin__body"),s=0,o="",r="";function a(e){var n=i.find("label");"object"==typeof e&&void 0!==e.message?(n.removeClass("installing success error").addClass(e.message.toLowerCase()),(void 0===e.done||!e.done)&&void 0!==e.url?e.hash==r?(n.removeClass("installing success").addClass("error"),d()):(r=e.hash,jQuery.post(e.url,e,a).fail(a)):d()):l()}function l(){o&&(i.find("input:checkbox").is(":checked")?jQuery.post(merlin_params.ajaxurl,{action:"merlin_plugins",wpnonce:merlin_params.wpnonce,slug:o},a).fail(a):(i.addClass("skipping"),setTimeout(d,300)))}function d(){i&&(i.data("done_item")||(s++,i.data("done_item",1)),i.find(".spinner").css("visibility","hidden"));var e=_(".merlin__drawer--install-plugins li");e.each(function(){var e=_(this);return!!e.data("done_item")||(o=e.data("slug"),i=e,l(),!1)}),s>=e.length&&n()}return{init:function(e){_(".merlin__drawer--install-plugins").addClass("installing"),_(".merlin__drawer--install-plugins").find("input").prop("disabled",!0),n=function(){setTimeout(function(){_(".merlin__body").addClass("js--finished")},1e3),t.removeClass(drawer_opened),setTimeout(function(){_(".merlin__body").addClass("exiting")},3e3),setTimeout(function(){window.location.href=e.href},3500)},d()}}}function o(){var i,t,s,n=_(".merlin__body"),o=0,r="",a="",l=1,d=0;function c(e){var n=t.find("label");"object"==typeof e&&void 0!==e.message?(n.addClass(e.message.toLowerCase()),void 0!==e.num_of_imported_posts&&0<d&&(l="all"===e.num_of_imported_posts?d:e.num_of_imported_posts,u()),void 0!==e.url?e.hash===a?(n.addClass("status--failed"),m()):(a=e.hash,void 0===e.selected_index&&(e.selected_index=_(".js-merlin-demo-import-select").val()||0),jQuery.post(e.url,e,c).fail(c)):(e.done,m())):(console.log(e),n.addClass("status--error"),m())}function m(){var e=!1,n=(t&&(t.data("done_item")||(o++,t.data("done_item",1)),t.find(".spinner").css("visibility","hidden")),_(".merlin__drawer--import-content__list-item"));_(".merlin__drawer--import-content__list-item input:checked");n.each(function(){""==r||e?(r=_(this).data("content"),t=_(this),r&&(t.find("input:checkbox").is(":checked")?jQuery.post(merlin_params.ajaxurl,{action:"merlin_content",wpnonce:merlin_params.wpnonce,content:r,selected_index:_(".js-merlin-demo-import-select").val()||0},c).fail(c):(t.addClass("skipping"),setTimeout(m,300))),e=!1):_(this).data("content")==r&&(e=!0)}),o>=n.length&&i()}function u(){_(".js-merlin-progress-bar").css("width",l/d*100+"%");e=l/d*100,n=0,i=99;var e,n,i=Math.min(i,Math.max(n,e));_(".js-merlin-progress-bar-percentage").html(Math.round(i)+"%"),1==l/d&&clearInterval(s)}return{init:function(e){_(".merlin__drawer--import-content").addClass("installing"),_(".merlin__drawer--import-content").find("input").prop("disabled",!0),i=function(){_.post(merlin_params.ajaxurl,{action:"merlin_import_finished",wpnonce:merlin_params.wpnonce,selected_index:_(".js-merlin-demo-import-select").val()||0}),setTimeout(function(){_(".js-merlin-progress-bar-percentage").html("100%")},100),setTimeout(function(){n.removeClass(drawer_opened)},500),setTimeout(function(){_(".merlin__body").addClass("js--finished")},1500),setTimeout(function(){_(".merlin__body").addClass("exiting")},3400),setTimeout(function(){window.location.href=e.href},4e3)},_(".merlin__drawer--import-content__list-item .checkbox-content").is(":checked")&&jQuery.post(merlin_params.ajaxurl,{action:"merlin_get_total_content_import_items",wpnonce:merlin_params.wpnonce,selected_index:_(".js-merlin-demo-import-select").val()||0},function(e){0<(d=e.data)&&(u(),s=setInterval(function(){l+=d/500,u()},1e3))}),m()}}}return{init:function(){_(e)},callback:function(e){console.log(e),console.log(this)}}}(jQuery);Merlin.init();
var Merlin=function(n){function e(){var e=n(".merlin__body"),i=(n(".merlin__body--loading"),n(".merlin__body--exiting"),n("#merlin__drawer-trigger"));drawer_opened="merlin__drawer--open",setTimeout(function(){e.addClass("loaded")},100),i.on("click",function(){e.toggleClass(drawer_opened)}),n(".merlin__button--proceed:not(.merlin__button--closer)").click(function(n){n.preventDefault();var i=this.getAttribute("href");e.addClass("exiting"),setTimeout(function(){window.location=i},400)}),n(".merlin__button--closer").on("click",function(n){e.removeClass(drawer_opened),n.preventDefault();var i=this.getAttribute("href");setTimeout(function(){e.addClass("exiting")},600),setTimeout(function(){window.location=i},1100)}),n(".button-next").on("click",function(e){e.preventDefault();var i=s(this);if(!i)return!1;var t=n(this).data("callback");return t&&"undefined"!=typeof d[t]?(d[t](this),!1):!0})}function i(){function e(n){"undefined"!=typeof n.done?(setTimeout(function(){a.addClass("lead")},0),setTimeout(function(){a.addClass("success"),a.html(n.message)},600),t()):(a.addClass("lead error"),a.html(n.error))}function i(){jQuery.post(merlin_params.ajaxurl,{action:"merlin_child_theme",wpnonce:merlin_params.wpnonce},e).fail(e)}var t,o=n(".merlin__body"),a=n("#child-theme-text");return{init:function(e){t=function(){setTimeout(function(){n(".merlin__body").addClass("js--finished")},1500),o.removeClass(drawer_opened),setTimeout(function(){n(".merlin__body").addClass("exiting")},3500),setTimeout(function(){window.location.href=e.href},4e3)},i()}}}function t(){function e(n){"undefined"!=typeof n.done?(setTimeout(function(){a.addClass("lead")},0),setTimeout(function(){a.addClass("success"),a.html(n.message)},600),t()):(a.addClass("lead error"),a.html(n.error))}function i(){childThemeName=n("#theme_license_key").val(),jQuery.post(merlin_params.ajaxurl,{action:"merlin_activate_license",wpnonce:merlin_params.wpnonce,cThemeName:childThemeName},e).fail(e)}var t,o=n(".merlin__body"),a=n("#child-theme-text");return{init:function(e){t=function(){setTimeout(function(){n(".merlin__body").addClass("js--finished")},1500),o.removeClass(drawer_opened),setTimeout(function(){n(".merlin__body").addClass("exiting")},3500),setTimeout(function(){window.location.href=e.href},4e3)},i()}}}function o(){function e(n){"object"==typeof n&&"undefined"!=typeof n.message?(a.find("span").text(n.message),"undefined"!=typeof n.url?n.hash==l?(a.find("span").text("failed"),t()):(l=n.hash,jQuery.post(n.url,n,function(n){i()}).fail(e)):("undefined"!=typeof n.done,t())):(a.find("span").text("Success"),t())}function i(){d&&jQuery.post(merlin_params.ajaxurl,{action:"merlin_plugins",wpnonce:merlin_params.wpnonce,slug:d},e).fail(e)}function t(){var e=!1;a&&(a.data("done_item")||(r++,a.data("done_item",1)),a.find(".spinner").css("visibility","hidden"));var t=n(".merlin__drawer--install-plugins li");t.each(function(){""==d||e?(d=n(this).data("slug"),a=n(this),i(),e=!1):n(this).data("slug")==d&&(e=!0)}),r>=t.length&&o()}var o,a,s=n(".merlin__body"),r=0,d="",l="";return{init:function(e){n(".merlin__drawer--install-plugins").addClass("installing"),o=function(){setTimeout(function(){n(".merlin__body").addClass("js--finished")},1e3),s.removeClass(drawer_opened),setTimeout(function(){n(".merlin__body").addClass("exiting")},3e3),setTimeout(function(){window.location.href=e.href},3500)},t()}}}function a(){function e(n){var i=a.find("label");"object"==typeof n&&"undefined"!=typeof n.message?(i.addClass(n.message.toLowerCase()),"undefined"!=typeof n.url?n.hash===l?(i.addClass("status--failed"),t()):(l=n.hash,jQuery.post(n.url,n,e).fail(e)):("undefined"!=typeof n.done,t())):(console.log(n),i.addClass("status--error"),t())}function i(){if(d){var n=a.find("input:checkbox");n.is(":checked")?jQuery.post(merlin_params.ajaxurl,{action:"merlin_content",wpnonce:merlin_params.wpnonce,content:d},e).fail(e):(a.addClass("skipping"),setTimeout(t,300))}}function t(){var e=!1;a&&(a.data("done_item")||(r++,a.data("done_item",1)),a.find(".spinner").css("visibility","hidden"));var t=n(".merlin__drawer--import-content__list-item");n(".merlin__drawer--import-content__list-item input:checked");t.each(function(){""==d||e?(d=n(this).data("content"),a=n(this),i(),e=!1):n(this).data("content")==d&&(e=!0)}),r>=t.length&&o()}var o,a,s=n(".merlin__body"),r=0,d="",l="";return{init:function(e){n(".merlin__drawer--import-content").addClass("installing"),n(".merlin__drawer--import-content").find("input").prop("disabled",!0),o=function(){setTimeout(function(){s.removeClass(drawer_opened)},500),setTimeout(function(){n(".merlin__body").addClass("js--finished")},1500),setTimeout(function(){n(".merlin__body").addClass("exiting")},3400),setTimeout(function(){window.location.href=e.href},4e3)},t()}}}function s(n){var e=jQuery(n);if("yes"==e.data("done-loading"))return!1;var i=!1;e.is("input")||e.is("button")?"val":"text";return e.data("done-loading","yes"),e.addClass("merlin__button--loading"),{done:function(){i=!0,e.attr("disabled",!1)}}}var r,d={install_child:function(n){var e=new i;e.init(n)},activate_license:function(n){var e=new t;e.init(n)},install_plugins:function(n){var e=new o;e.init(n)},install_content:function(n){var e=new a;e.init(n)}};return{init:function(){r=this,n(e)},callback:function(n){console.log(n),console.log(this)}}}(jQuery);Merlin.init();